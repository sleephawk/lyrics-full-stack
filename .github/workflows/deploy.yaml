backend:
  name: Deploy Backend to Railway
  runs-on: ubuntu-latest
  env:
    MYSQLHOST: ${{ secrets.MYSQLHOST }}
    MYSQLPORT: ${{ secrets.MYSQLPORT }}
    MYSQLPASSWORD: ${{ secrets.MYSQLPASSWORD }}
    PORT: 8080
  steps:
    - name: Checkout code
      uses: actions/checkout@v4
    - name: Setup Maven
      uses: actions/setup-java@v4
      with:
        distribution: temurin
        java-version: 21
        cache: maven
    - name: Build Spring Boot
      working-directory: ./lyrics-api-springboot
      run: mvn clean package -DskipTests
    - name: Install Railway CLI
      run: npm install -g @railway/cli
    - name: Deploy to Railway
      working-directory: ./lyrics-api-springboot
      run: railway up --detached
      env:
        RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
        RAILWAY_PROJECT_ID: ${{ secrets.RAILWAY_PROJECT_ID }}
